import numpy as np
import matplotlib.pyplot as plt
import os

name = "vgg16_1e-4_da_step.png"
data = [[0.25077658284590143, 89.94331359863281, 0.31217587278661085, 86.70654296875], [0.21503508937394145, 91.39213562011719, 0.27052685719536385, 88.665771484375], [0.19738177207909757, 92.17453002929688, 0.26999683465328417, 88.9617919921875], [0.18087371745718883, 93.01300048828125, 0.26699666141939815, 89.4134521484375], [0.2011609279481945, 91.85600280761719, 0.2748601517487259, 88.824462890625], [0.16600867686531728, 93.67485046386719, 0.27371064737599227, 89.3157958984375], [0.17190059804897828, 93.27583312988281, 0.27099726396409096, 89.4317626953125], [0.1649487696813594, 93.81866455078125, 0.3010851614308194, 88.250732421875], [0.1663582424262131, 93.45054626464844, 0.26985360659273283, 89.4683837890625], [0.14583514988839852, 94.52133178710938, 0.2593544357914652, 90.1031494140625], [0.1355555589820483, 94.96231079101562, 0.27891032383377024, 89.7125244140625], [0.13543501072444997, 94.95582580566406, 0.2865923861036208, 89.70947265625], [0.1343652666109847, 95.02296447753906, 0.29017817431667936, 89.4683837890625], [0.13402380500747313, 95.00541687011719, 0.2786037983605638, 89.88037109375], [0.1333874966408075, 95.05500793457031, 0.2774540807640733, 89.8895263671875], [0.13166529585055287, 95.13282775878906, 0.2991110280227076, 89.2791748046875], [0.13216445342220595, 95.10765075683594, 0.2840955072424549, 89.739990234375], [0.13112906897026733, 95.12176513671875, 0.2869637303538184, 89.7064208984375], [0.13096557438814216, 95.18966674804688, 0.2848364557212335, 89.6514892578125], [0.1304904846261934, 95.21064758300781, 0.2957433610681619, 89.4775390625], [0.1295224133392594, 95.22514343261719, 0.28970294121972984, 89.6148681640625], [0.1298470046268676, 95.17860412597656, 0.2849733524835756, 89.862060546875], [0.12912190400834334, 95.21102905273438, 0.282471908696607, 89.8712158203125], [0.1292677286126036, 95.20835876464844, 0.28554728467315726, 89.8284912109375], [0.1301426343455887, 95.18318176269531, 0.2905737925430003, 89.6087646484375]]




save_dir_loss = "./p3acc/"
save_dir_acc = "./p3loss/"
os.makedirs(save_dir_loss, exist_ok=True)
os.makedirs(save_dir_acc, exist_ok=True)

# Extract data
train_loss = [x[0] for x in data]
val_loss = [x[2] for x in data]
train_acc = [x[1] for x in data]
val_acc = [x[3] for x in data]

indices = np.arange(1, len(train_loss) + 1)


plt.figure()
plt.plot(indices, train_loss, marker='o', linestyle='-', label='Train Loss')
plt.plot(indices, val_loss, marker='s', linestyle='--', label='Validation Loss')
plt.xlabel("Epoch")
plt.ylabel("Loss")
plt.legend()
plt.savefig(os.path.join(save_dir_loss, name), dpi=300, bbox_inches='tight')

plt.figure()
plt.plot(indices, train_acc, marker='o', linestyle='-', label='Train Accuracy')
plt.plot(indices, val_acc, marker='s', linestyle='--', label='Validation Accuracy')
plt.xlabel("Epoch")
plt.ylabel("Accuracy (%)")
plt.legend()
plt.savefig(os.path.join(save_dir_acc, name), dpi=300, bbox_inches='tight')
